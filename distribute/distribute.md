## 一致性

* 强一致性：假如A先写入一个值到存储系统，存储系统能够保证后续ABC读取操作都将返回最新值。
* 弱一致性：假如A先写入一个值到存储系统，系统不能保证ABC的读取操作能否读取到最新值。
* 最终一致性：~，后续没有写操作更新同样的值，ABC的读取操作最终都会读取到A写入的最新值。从A写入，到ABC读取到最新值的这段时间，称为“不一致性窗口”。

## 数据分布与负载均衡

负载的衡量有很多因素，load值，cpu，内存，磁盘，网络等。

### 哈希分布
一致哈希的便利在于，集群数量变化时可以方便的扩容和数据迁移（只影响到相邻结点）。另一个特点是，相同id请求总是发到同一台服务器，这样同一个用户id的数据不会被散列到不同服务器，但缺点也是在用户数据量大的时候可能造成过载（还有种说法是所有数据限定在同一个存储节点，无法发挥分布式多机并行处理的能力）。对于大用户，可以将它的数据再进行拆分处理。

数据迁移过程中的负载问题，5.1节

### 顺序分布
哈希分布破坏了数据的有序性，只能支持随机读取，不能支持顺序扫描。  

顺序分布就是将大表划分为连续的小表，与B+树结构类似  


### 数据迁移
负载均衡做？不是吧！

假设数据分片D有两个副本D1D2分别在结点A1A2，D1为主副本，D2为从副本，迁移D1到其他结点的过程为：
1. 将数据分片D的读写服务有A1切换到A2，D2变成主副本。
2. 选择一个新的结点B，**从A2结点获取D2的数据**并与之保持同步。
3. 从A1删除D1副本。

## 复制